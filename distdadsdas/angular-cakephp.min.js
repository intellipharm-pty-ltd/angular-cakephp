"use strict";!function(){angular.module("AngularCakePHP").value("AngularCakePHPApiUrl","http://example.com/api").value("AngularCakePHPGenerateEndPoint",!1)}(),function(){angular.module("AngularCakePHP",[])}(),function(){function a(){this.model}var b="Missing Required Params",c="Name argument is required",d="Name argument needs to be a string",e="Name argument is not in the object",f="Name argument is not a virtual field",g="Value argument is required",h="Value argument needs to be a function";a.$inject=[],a.prototype.extend=function(c,d){if(_.isUndefined(c)||!_.has(c,"active_record_class")||_.isUndefined(c.active_record_class)||_.isUndefined(d))throw new Error(b);c.active_record_class.prototype=Object.create(a.prototype);var e=new c.active_record_class(d);return e.model=c,e},a.prototype.save=function(){return this.id?this.model.edit(this.id,this):this.model.add(this)},a.prototype["new"]=function(a){return this.model["new"](a)},a.prototype["delete"]=function(){return this.model["delete"](this.id)},a.prototype.validate=function(a){return this.model.validate(this,a)},a.prototype.getClassName=function(){return this.model&&this.model.active_record_class?this.model.active_record_class.name:null},a.prototype.virtualField=function(a,b){var e;if(!a)throw new Error(c);if("string"!=typeof a)throw new Error(d);if(!b)throw new Error(g);if("function"!=typeof b)throw new Error(h);return Object.defineProperty(this,a,{enumerable:!1,configurable:!1,get:function(){return e},set:function(){return e=b.apply(this)}}),this.virtualFieldUpdate(a),this},a.prototype.virtualFieldUpdate=function(a){if(!a)throw new Error(c);if("string"!=typeof a)throw new Error(d);if(!a in this)throw new Error(e);if(this.propertyIsEnumerable(a))throw new Error(f);return this[a]="",this},angular.module("AngularCakePHP").service("BaseActiveRecord",a)}(),function(){function a(a,k,l,m,n,o,p,q,r){b=a,c=k,d=l,i=m,j=n,e=o,f=p,g=q,h=r,this.active_record_class,this.config={api:i,api_endpoint:null,api_endpoint_auto:!0}}var b,c,d,e,f,g,h,i,j,k="Invalid Config",l="Missing Required Params";a.$inject=["$http","$injector","$q","AngularCakePHPApiUrl","AngularCakePHPGenerateEndPoint","UtilService","HttpResponseService","TransformerService","BaseActiveRecord"],a.prototype.extend=function(b,c){if(_.isUndefined(b)||_.isUndefined(c))throw new Error(l);b.prototype=Object.create(a.prototype);var d=new b;return d.active_record_class=c,d.config=_.merge(_.clone(this.config),d.config),_.isNull(d.config.api_endpoint)&&d.config.api_endpoint_auto&&(d.config.api_endpoint=pluralize(_.snakeCase(d.active_record_class.name))),d},a.prototype["new"]=function(a){_.isUndefined(a)&&(a={});var b=h.extend(this,a);return _.forEach(a,function(a,c){if(_.isArray(a)){var d=e.getAssociationArray(a,c);_.isEmpty(d)||(b[c]=d)}else if(_.isObject(a)){var f=e.getAssociation(a,c);f!==!1&&(b[c]=f)}},this),b},a.prototype.index=function(a){var c=this;if(console.log(this.config.api_endpoint),!_.has(this.config,"api_endpoint")||_.isNull(this.config.api_endpoint)||_.isUndefined(this.config.api_endpoint))throw new Error(k);return d(function(d,e){var h=g.transformRequestUrl(c.config.api,c.config.api_endpoint,a);b.get(h).success(function(a,b,g,h){f.handleIndexResponse(d,e,c,a,b,g,h)}).error(function(a,b,g,h){f.handleErrorResponse(d,e,c,a,b,g,h)})})},a.prototype.view=function(a,c){var e=this;if(!_.has(this.config,"api_endpoint")||_.isNull(this.config.api_endpoint)||_.isUndefined(this.config.api_endpoint))throw new Error(k);if(_.isNull(a)||_.isUndefined(a))throw new Error(l);return d(function(d,h){var i=g.transformRequestUrl(e.config.api,e.config.api_endpoint,c,a);b.get(i).success(function(a,b,c,g){f.handleViewResponse(d,h,e,a,b,c,g)}).error(function(a,b,c,g){f.handleErrorResponse(d,h,e,a,b,c,g)})})},a.prototype.add=function(a){var c=this;if(!_.has(this.config,"api_endpoint")||_.isNull(this.config.api_endpoint)||_.isUndefined(this.config.api_endpoint))throw new Error(k);if(_.isNull(a)||_.isUndefined(a))throw new Error(l);return d(function(d,e){var h=g.transformRequestUrl(c.config.api,c.config.api_endpoint);a=g.transformRequestData(a),b.post(h,a).success(function(a,b,g,h){f.handleAddResponse(d,e,c,a,b,g,h)}).error(function(a,b,g,h){f.handleErrorResponse(d,e,c,a,b,g,h)})})},a.prototype.edit=function(a,c){var e=this;if(!_.has(this.config,"api_endpoint")||_.isNull(this.config.api_endpoint)||_.isUndefined(this.config.api_endpoint))throw new Error(k);if(_.isNull(a)||_.isUndefined(a))throw new Error(l);if(_.isNull(c)||_.isUndefined(c))throw new Error(l);return d(function(d,h){var i=g.transformRequestUrl(e.config.api,e.config.api_endpoint,null,a);c=g.transformRequestData(c),b.put(i,c).success(function(a,b,c,g){f.handleEditResponse(d,h,e,a,b,c,g)}).error(function(a,b,c,g){f.handleErrorResponse(d,h,e,a,b,c,g)})})},a.prototype["delete"]=function(a){var c=this;if(!_.has(this.config,"api_endpoint")||_.isNull(this.config.api_endpoint)||_.isUndefined(this.config.api_endpoint))throw new Error(c.ERROR_INVALID_CONFIG);if(_.isNull(a)||_.isUndefined(a))throw new Error(c.ERROR_MISSING_PARAMS);return d(function(d,e){var h=g.transformRequestUrl(c.config.api,c.config.api_endpoint,null,a);b["delete"](h).success(function(a,b,g,h){f.handleDeleteResponse(d,e,c,a,b,g,h)}).error(function(a,b,g,h){f.handleErrorResponse(d,e,c,a,b,g,h)})})},a.prototype.validate=function(a,c){var e=this;if(!_.has(this.config,"api_endpoint")||_.isNull(this.config.api_endpoint)||_.isUndefined(this.config.api_endpoint))throw new Error(e.ERROR_INVALID_CONFIG);if(_.isNull(a)||_.isUndefined(a))throw new Error(e.ERROR_MISSING_PARAMS);return d(function(d,h){var i=null;_.isUndefined(c)||(i={fields:c.join(",")});var j=g.transformRequestUrl(e.config.api,e.config.api_endpoint+"/validation",i),k=a;b.post(j,k).success(function(a,b,c,g){f.handleValidateResponse(d,h,e,a,b,c,g)}).error(function(a,b,c,g){f.handleValidateErrorResponse(d,h,e,a,b,c,g)})})},a.prototype.api=function(a,c,d){var e=this;if(_.isUndefined(d)&&(d="GET"),_.isUndefined(c)&&(c={}),d=d.toUpperCase(),!_.has(this.config,"api_endpoint")||_.isNull(this.config.api_endpoint)||_.isUndefined(this.config.api_endpoint))throw new Error(e.ERROR_INVALID_CONFIG);if(_.isNull(a)||_.isUndefined(a))throw new Error(e.ERROR_MISSING_PARAMS);var f=null,h=[];"GET"===d?f=[]:h=c;var i=g.transformRequestUrl(e.config.api,e.config.api_endpoint+"/"+a,f);return b({url:i,data:h,method:d})},angular.module("AngularCakePHP").service("AngularCakePHPBaseModel",a)}(),function(){var a=function(){this.build=function(b,c){var d=_.isUndefined(c)?"":c,e=a(b,d,"");return e.substring(1,e.length)};var a=function(b,c,d,e){e=_.isUndefined(e)?!1:e,"string"==typeof b&&(b=b.split(","));for(var f in b)if(_.isArray(b[f]))for(var g=0;g<b[f].length;g++)if(_.isObject(b[f][g]))for(var h in b[f][g])d+="&"+c+"["+f+"]["+h+"]="+b[f][g][h];else d+="&"+c+"["+f+"]["+g+"]="+b[f][g];else _.isArray(b)&&_.isObject(b[f])?d=a(b[f],c,d):_.isObject(b[f])?(d+="&"+c+"["+f+"]",d=a(b[f],c,d,!0)):d+=e?"["+f+"]="+b[f]:"&"+c+"["+f+"]="+b[f];return d}};angular.module("AngularCakePHP").service("HttpQueryBuildService",a)}(),function(){var a=function(){this.prepareRequest=function(){var a=[];_(response.data).forEach(function(b){_.merge(b,b[model.active_record_class.name]),delete b[model.active_record_class.name],a.push(model["new"](b))}),resolve(a)}};a.$inject=["$q"],angular.module("AngularCakePHP").service("HttpRequestService",a)}(),function(){var a=function(a){this.handleIndexResponse=function(b,c,d,e){var f=a.transformResponseDataList(e.data,d);b({data:f})},this.handleViewResponse=function(b,c,d,e){var f=a.transformResponseData(e.data,d);b({data:f})},this.handleAddResponse=function(a,b,c,d){a({message:d.message,data:d.data})},this.handleEditResponse=function(a,b,c,d){a({message:d.message})},this.handleDeleteResponse=function(a,b,c,d){a({message:d.message})},this.handleValidateResponse=function(a,b,c,d){a({message:d.message})},this.handleValidateErrorResponse=function(a,b,c,d){b({data:d.data,message:d.message})},this.handleErrorResponse=function(a,b,c,d){b({message:d.message})}};a.$inject=["TransformerService"],angular.module("AngularCakePHP").service("HttpResponseService",a)}(),function(){var a=function(a){this.transformRequestUrl=function(b,c,d,e){var f=[];_.isUndefined(d)||_.isNull(d)||_.isEmpty(d)||_.forEach(d,function(b,c){"contain"===c?f.push(a.build(b,"contain")):c&&b&&f.push(c+"="+b)});var g="";f.length>0&&(g="?"+f.join("&"));var h=_.isUndefined(e)||_.isNull(e)?"":"/"+e,i=b+"/"+c+h+g;return i=i.replace(/([^:]\/)\/+/g,"$1")},this.transformRequestData=function(a){var b=_.clone(a,!0);return _.has(b,"model")&&delete b.model,_.forEach(b,function(a){_.isArray(a)?_.forEach(a,function(a){a=this.transformRequestData(a)},this):_.isObject(a)&&(a=this.transformRequestData(a))},this),b},this.transformResponseDataList=function(a,b){var c=[];return _.forEach(a,function(a){c.push(this.transformResponseData(a,b))},this),c},this.transformResponseData=function(a,b){return _.merge(a,a[b.active_record_class.name]),delete a[b.active_record_class.name],b["new"](a)}};a.$inject=["HttpQueryBuildService"],angular.module("AngularCakePHP").service("TransformerService",a)}(),function(){var a=function(a){var b=this;this.ERROR_MODEL_DOES_NOT_EXIST="Model does not exist",this.ERROR_NO_DATA="No Data",this.getAssociationArray=function(a,b){var c=[],d=b+"Model";return _.forEach(a,function(a){var e=this.getAssociation(a,b,d);e!==!1&&c.push(e)},this),c},this.getAssociation=function(c,d,e){if(_.isNumber(c))return c;if(_.isUndefined(e)&&(e=d+"Model"),_.has(c,"id")&&_.isNull(c.id))return console.error(b.ERROR_NO_DATA+": "+e),!1;try{var f=a.get(e),g=f["new"](c);return g}catch(h){return console.error(b.ERROR_MODEL_DOES_NOT_EXIST+": "+e),!1}}};a.$inject=["$injector"],angular.module("AngularCakePHP").service("UtilService",a)}();
//# sourceMappingURL=angular-cakephp.min.js.map